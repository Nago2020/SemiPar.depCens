% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/fitdependentCensorigModels.R
\name{fitDepCens}
\alias{fitDepCens}
\title{Fit Dependent Censoring Models}
\usage{
fitDepCens(
  resData,
  X,
  W,
  cop = c("Frank", "Gumbel", "Normal"),
  dist = c("Weibull", "lognormal"),
  start = NULL,
  n.iter = 20,
  bootstrap = TRUE,
  n.boot = 50,
  eps = 0.001
)
}
\arguments{
\item{resData}{Data matrix with three columns;  Z = the observed survival time, d1 = the censoring indicator of T
and  d2 =  the censoring indicator of C.}

\item{X}{Data matrix with covariates related to T.}

\item{W}{Data matrix with covariates related to C. First column of W should be a vector of ones.}

\item{cop}{Which copula should be computed to account for dependency between T and C. This argument can take
one of the values from \code{c("Gumbel", "Frank", "Normal")}.}

\item{dist}{The distribution to be used for the censoring time C. Only two distributions are allowed, i.e, Weibull
and lognormal distributions. With the value \code{"Weibull"} as the
default.}

\item{start}{Initial values for the finite dimensional parameters. If \code{start} is NULL, the initial values will be obtained
by fitting a Cox model for survival time T and a Weibull model for dependent censoring C.}

\item{n.iter}{Number of iterations; the default is \code{n.iter = 20}. The larger the number of iterations, the longer the computational time.}

\item{bootstrap}{A boolean indicating whether to compute bootstrap standard errors for making inferences.}

\item{n.boot}{Number of bootstrap samples to use in the estimation of bootstrap standard errors if \code{bootstrap = TRUE}. The default is n.boot = 50. But, higher
values  of \code{n.boot} are recommended for obtaining good estimates of bootstrap standard errors.
@importFrom copula pCopula frankCopula gumbelCopula tau}

\item{eps}{Convergence error. This is set by the user in such away that the desired convergence is met; the default is \code{eps = 1e-3}.}
}
\value{
This function returns a fit of dependent censoring model; parameter estimates, estimate of the cumulative hazard function, bootstrap standard
errors for finite-dimensional parameters, the nonparametric cumulative hazard function, etc.
}
\description{
This function allows to estimate the dependency parameter along all other model parameters. First, estimates the cumulative hazard function, and
then at the second stage it estimates other model parameters assuming that the cumulative hazard function is known.
}
\examples{
\dontrun{

Transform the follic data to the form suitable for analysis
follic = follic[order(follic$time),]
Z = round(follic$time,digits = 3)
d1 = as.numeric(follic$status==1)                   # survival time indicator
d2 = as.numeric(follic$status==2)                   # censoring indicator
x1 = as.numeric(follic$ch=="Y")                     # treatment indicator
x2 = (follic$age-mean(follic$age))/sd(follic$age)   # standardize continuous variables
x3 = (follic$hgb-mean(follic$hgb))/sd(follic$hgb)   # standardized hemoglobin
x4 = as.numeric(follic$clinstg==1)                  # clinical stage
X = cbind(x1,x2,x3,x4)                              # data matrix for T
W = cbind(rep(1,length(Z)),X)                       # data matrix for C
resData = data.frame("Z" = Z,"d1" = d1, "d2" = d2)  # resData should be a data frame

fitD <- fitDepCens(resData = resData, X = X, W = W, bootstrap = F)
 # bootstrap = F does not produce SE
#fitD <- fitDepCens(resData = resData, X = X, W = W, bootstrap = T, n.boot = 100)
 summary(fitD)
# bootstrapping takes long time, try smaller n.boot for a quick overview of results

}

}
